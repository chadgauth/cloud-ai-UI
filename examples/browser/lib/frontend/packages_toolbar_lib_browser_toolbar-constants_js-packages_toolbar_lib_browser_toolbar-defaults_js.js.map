{"version":3,"file":"packages_toolbar_lib_browser_toolbar-constants_js-packages_toolbar_lib_browser_toolbar-defaults_js.js","mappings":"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","sources":["webpack:///../../packages/toolbar/src/browser/toolbar-constants.ts?","webpack:///../../packages/toolbar/src/browser/toolbar-defaults.ts?","webpack:///../../packages/toolbar/src/browser/toolbar-interfaces.ts?","webpack:///../../packages/userstorage/src/browser/index.ts?","webpack:///../../packages/userstorage/src/browser/user-storage-contribution.ts?","webpack:///../../packages/userstorage/src/browser/user-storage-frontend-module.ts?","webpack:///../../packages/userstorage/src/browser/user-storage-uri.ts?"],"sourcesContent":["// *****************************************************************************\n// Copyright (C) 2022 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Command, isObject, MenuPath, nls } from '@theia/core';\nimport { CommonCommands } from '@theia/core/lib/browser';\nimport URI from '@theia/core/lib/common/uri';\nimport { UserStorageUri } from '@theia/userstorage/lib/browser';\n\nexport namespace ToolbarCommands {\n    export const TOGGLE_TOOLBAR = Command.toLocalizedCommand({\n        id: 'toolbar.view.toggle',\n        category: CommonCommands.VIEW_CATEGORY,\n        label: 'Toggle Toolbar',\n    }, 'theia/toolbar/toggleToolbar', nls.getDefaultKey(CommonCommands.VIEW_CATEGORY));\n\n    export const REMOVE_COMMAND_FROM_TOOLBAR = Command.toLocalizedCommand({\n        id: 'toolbar.remove.command',\n        category: 'Toolbar',\n        label: 'Remove Command From Toolbar',\n    }, 'theia/toolbar/removeCommand');\n\n    export const INSERT_GROUP_LEFT = Command.toLocalizedCommand({\n        id: 'toolbar.insert.group.left',\n        category: 'Toolbar',\n        label: 'Insert Group Separator (Left)',\n    }, 'theia/toolbar/insertGroupLeft');\n\n    export const INSERT_GROUP_RIGHT = Command.toLocalizedCommand({\n        id: 'toolbar.insert.group.right',\n        category: 'Toolbar',\n        label: 'Insert Group Separator (Right)',\n    }, 'theia/toolbar/insertGroupRight');\n\n    export const ADD_COMMAND_TO_TOOLBAR = Command.toLocalizedCommand({\n        id: 'toolbar.add.command',\n        category: 'Toolbar',\n        label: 'Add Command to Toolbar',\n    }, 'theia/toolbar/addCommand');\n\n    export const RESET_TOOLBAR = Command.toLocalizedCommand({\n        id: 'toolbar.restore.defaults',\n        category: 'Toolbar',\n        label: 'Restore Toolbar Defaults',\n    }, 'theia/toolbar/restoreDefaults');\n\n    export const CUSTOMIZE_TOOLBAR = Command.toLocalizedCommand({\n        id: 'toolbar.customize',\n        category: 'Toolbar',\n        label: 'Customize Toolbar (Open JSON)',\n    }, 'theia/toolbar/openJSON');\n}\n\nexport const UserToolbarURI = Symbol('UserToolbarURI');\nexport const USER_TOOLBAR_URI = new URI().withScheme(UserStorageUri.scheme).withPath('/user/toolbar.json');\nexport namespace ToolbarMenus {\n    export const TOOLBAR_ITEM_CONTEXT_MENU: MenuPath = ['toolbar:toolbarItemContextMenu'];\n    export const TOOLBAR_BACKGROUND_CONTEXT_MENU: MenuPath = ['toolbar:backgroundContextMenu'];\n    export const SEARCH_WIDGET_DROPDOWN_MENU: MenuPath = ['searchToolbar:dropdown'];\n}\n\nexport type ReactInteraction<T = Element, U = MouseEvent> = React.MouseEvent<T, U> | React.KeyboardEvent<T>;\nexport namespace ReactKeyboardEvent {\n    export function is(obj: unknown): obj is React.KeyboardEvent {\n        return isObject(obj) && 'key' in obj;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2022 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { nls } from '@theia/core';\nimport { DeflatedToolbarTree, ToolbarAlignment } from './toolbar-interfaces';\n\n// This file specifies the default layout of the toolbar. This binding should be overridden for extenders.\n// Both Toolbar Command Items and Toolbar Contributions can be specified here.\nexport const ToolbarDefaultsFactory = Symbol('ToolbarDefaultsFactory');\nexport const ToolbarDefaults: () => DeflatedToolbarTree = () => ({\n    items: {\n        [ToolbarAlignment.LEFT]: [\n            [\n                {\n                    id: 'textEditor.commands.go.back',\n                    command: 'textEditor.commands.go.back',\n                    icon: 'codicon codicon-arrow-left',\n                },\n                {\n                    id: 'textEditor.commands.go.forward',\n                    command: 'textEditor.commands.go.forward',\n                    icon: 'codicon codicon-arrow-right',\n                },\n            ],\n            [\n                {\n                    id: 'workbench.action.splitEditorRight',\n                    command: 'workbench.action.splitEditorRight',\n                    icon: 'codicon codicon-split-horizontal',\n                },\n            ],\n        ],\n        [ToolbarAlignment.CENTER]: [[]],\n        [ToolbarAlignment.RIGHT]: [\n            [\n                {\n                    id: 'workbench.action.showCommands',\n                    command: 'workbench.action.showCommands',\n                    icon: 'codicon codicon-terminal',\n                    tooltip: nls.localizeByDefault('Command Palette'),\n                },\n            ]\n        ]\n    },\n});\n","// *****************************************************************************\n// Copyright (C) 2022 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { ReactTabBarToolbarItem, TabBarToolbar, TabBarToolbarItem } from '@theia/core/lib/browser/shell/tab-bar-toolbar';\n\nexport enum ToolbarAlignment {\n    LEFT = 'left',\n    CENTER = 'center',\n    RIGHT = 'right'\n}\n\nexport interface ToolbarTreeSchema {\n    items: {\n        [key in ToolbarAlignment]: ToolbarItem[][];\n    };\n}\n\nexport interface DeflatedToolbarTree {\n    items: {\n        [key in ToolbarAlignment]: ToolbarItemDeflated[][];\n    };\n}\nexport namespace ToolbarAlignmentString {\n    export const is = (obj: unknown): obj is ToolbarAlignment => obj === ToolbarAlignment.LEFT\n        || obj === ToolbarAlignment.CENTER\n        || obj === ToolbarAlignment.RIGHT;\n}\n\nexport interface ToolbarContributionProperties {\n    toJSON(): DeflatedContributedToolbarItem;\n}\n\nexport type ToolbarContribution = ReactTabBarToolbarItem & ToolbarContributionProperties;\n\nexport const ToolbarContribution = Symbol('ToolbarContribution');\n\nexport const Toolbar = Symbol('Toolbar');\nexport const ToolbarFactory = Symbol('ToolbarFactory');\nexport type Toolbar = TabBarToolbar;\n\nexport type ToolbarItem = ToolbarContribution | TabBarToolbarItem;\nexport interface DeflatedContributedToolbarItem { id: string; group: 'contributed' };\nexport type ToolbarItemDeflated = DeflatedContributedToolbarItem | TabBarToolbarItem;\n\nexport const LateInjector = Symbol('LateInjector');\n\nexport const lateInjector = <T>(\n    context: interfaces.Container,\n    serviceIdentifier: interfaces.ServiceIdentifier<T>,\n): T => context.get<T>(serviceIdentifier);\n\nexport interface ToolbarItemPosition {\n    alignment: ToolbarAlignment;\n    groupIndex: number;\n    itemIndex: number;\n}\n\nexport enum IconSet {\n    FA = 'fa',\n    CODICON = 'codicon'\n}\n\n","// *****************************************************************************\n// Copyright (C) 2017 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nexport * from './user-storage-uri';\nexport * from './user-storage-frontend-module';\n","// *****************************************************************************\n// Copyright (C) 2020 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport URI from '@theia/core/lib/common/uri';\nimport { DisposableCollection } from '@theia/core/lib/common/disposable';\nimport { EnvVariablesServer } from '@theia/core/lib/common/env-variables';\nimport { FileSystemProvider } from '@theia/filesystem/lib/common/files';\nimport { FileService, FileServiceContribution } from '@theia/filesystem/lib/browser/file-service';\nimport { DelegatingFileSystemProvider } from '@theia/filesystem/lib/common/delegating-file-system-provider';\nimport { UserStorageUri } from './user-storage-uri';\n\n@injectable()\nexport class UserStorageContribution implements FileServiceContribution {\n\n    @inject(EnvVariablesServer)\n    protected readonly environments: EnvVariablesServer;\n\n    registerFileSystemProviders(service: FileService): void {\n        service.onWillActivateFileSystemProvider(event => {\n            if (event.scheme === UserStorageUri.scheme) {\n                event.waitUntil((async () => {\n                    const provider = await this.createProvider(service);\n                    service.registerProvider(UserStorageUri.scheme, provider);\n                })());\n            }\n        });\n    }\n\n    protected async createProvider(service: FileService): Promise<FileSystemProvider> {\n        const delegate = await service.activateProvider('file');\n        const configDirUri = new URI(await this.environments.getConfigDirUri());\n        return new DelegatingFileSystemProvider(delegate, {\n            uriConverter: {\n                to: resource => {\n                    const relativePath = UserStorageUri.relative(resource);\n                    if (relativePath) {\n                        return configDirUri.resolve(relativePath).normalizePath();\n                    }\n                    return undefined;\n                },\n                from: resource => {\n                    const relativePath = configDirUri.relative(resource);\n                    if (relativePath) {\n                        return UserStorageUri.resolve(relativePath);\n                    }\n                    return undefined;\n                }\n            }\n        }, new DisposableCollection(\n            delegate.watch(configDirUri, { excludes: [], recursive: true })\n        ));\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2017 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { ContainerModule } from '@theia/core/shared/inversify';\nimport { FileServiceContribution } from '@theia/filesystem/lib/browser/file-service';\nimport { UserStorageContribution } from './user-storage-contribution';\n\nexport default new ContainerModule(bind => {\n    bind(UserStorageContribution).toSelf().inSingletonScope();\n    bind(FileServiceContribution).toService(UserStorageContribution);\n});\n","// *****************************************************************************\n// Copyright (C) 2017 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport URI from '@theia/core/lib/common/uri';\n\nexport const UserStorageUri = new URI('user-storage:/user');\n"],"names":[],"sourceRoot":""}